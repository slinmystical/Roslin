<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROSLINE - –†–∞–±–æ—á–∏–π –ø–æ–∏—Å–∫</title>
</head>
<body>
    <h2>–ü–æ–∏—Å–∫ –∏–≥—Ä–æ–∫–∞ Roblox</h2>
    <input type="text" id="username" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫" style="padding:10px;width:250px;">
    <button onclick="searchRobloxUser()" style="padding:10px;">–ù–∞–π—Ç–∏</button>
    
    <div id="result" style="margin-top:20px;"></div>

    <script>
        // –†–ê–ë–û–ß–ò–ô –ü–û–ò–°–ö –ß–ï–†–ï–ó CORS –ü–†–û–ö–°–ò
        async function searchRobloxUser() {
            const username = document.getElementById('username').value.trim();
            const resultDiv = document.getElementById('result');
            
            if (!username) {
                resultDiv.innerHTML = '<p>–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫</p>';
                return;
            }
            
            resultDiv.innerHTML = '<p>üîç –ò—â–µ–º –≤ Roblox...</p>';
            
            try {
                // 1. –ò—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –Ω–∏–∫—É
                const searchUrl = `https://corsproxy.io/?url=${encodeURIComponent(`https://users.roblox.com/v1/users/search?keyword=${username}&limit=5`)}`;
                
                const searchResponse = await fetch(searchUrl);
                const searchData = await searchResponse.json();
                
                if (!searchData.data || searchData.data.length === 0) {
                    resultDiv.innerHTML = `<p>–ò–≥—Ä–æ–∫ "${username}" –Ω–µ –Ω–∞–π–¥–µ–Ω</p>`;
                    return;
                }
                
                // 2. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                let html = '<h3>–ù–∞–π–¥–µ–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–∏:</h3>';
                
                for (const user of searchData.data) {
                    // –ü–æ–ª—É—á–∞–µ–º –∞–≤–∞—Ç–∞—Ä
                    const avatarUrl = `https://thumbnails.roblox.com/v1/users/avatar-headshot?userIds=${user.id}&size=150x150&format=Png`;
                    const avatarProxy = `https://corsproxy.io/?url=${encodeURIComponent(avatarUrl)}`;
                    
                    html += `
                        <div style="border:1px solid #ccc; padding:10px; margin:5px 0; display:flex; align-items:center;">
                            <img src="https://www.roblox.com/headshot-thumbnail/image?userId=${user.id}&width=150&height=150&format=png" 
                                 width="50" height="50" style="border-radius:50%; margin-right:10px;">
                            <div>
                                <strong>${user.name}</strong><br>
                                <small>ID: ${user.id}</small><br>
                                <button onclick="selectPlayer(${user.id}, '${user.name}')" style="padding:5px 10px; margin-top:5px;">
                                    –í—ã–±—Ä–∞—Ç—å
                                </button>
                            </div>
                        </div>
                    `;
                }
                
                resultDiv.innerHTML = html;
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞:', error);
                resultDiv.innerHTML = `
                    <p>–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞. –ü—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥...</p>
                    <p><button onclick="searchAlternative()">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</button></p>
                `;
            }
        }
        
        // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –ø–æ–∏—Å–∫–∞
        async function searchAlternative() {
            const username = document.getElementById('username').value.trim();
            
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥—Ä—É–≥–æ–π –ø—Ä–æ–∫—Å–∏
            try {
                const url = `https://api.allorigins.win/get?url=${encodeURIComponent(`https://users.roblox.com/v1/users/search?keyword=${username}`)}`;
                const response = await fetch(url);
                const data = await response.json();
                
                const players = JSON.parse(data.contents).data;
                
                if (players && players.length > 0) {
                    let html = '<h3>–ù–∞–π–¥–µ–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–∏:</h3>';
                    players.forEach(player => {
                        html += `
                            <div style="border:1px solid #ccc; padding:10px; margin:5px 0;">
                                <strong>${player.name}</strong> (ID: ${player.id})<br>
                                <button onclick="selectPlayer(${player.id}, '${player.name}')">–í—ã–±—Ä–∞—Ç—å</button>
                            </div>
                        `;
                    });
                    document.getElementById('result').innerHTML = html;
                }
            } catch (error) {
                document.getElementById('result').innerHTML = `
                    <p>–í—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–µ–º–æ:</p>
                    <button onclick="useDemo('gighaner')">gighaner</button>
                    <button onclick="useDemo('builderman')">builderman</button>
                `;
            }
        }
        
        function selectPlayer(id, name) {
            alert(`‚úÖ –í—ã–±—Ä–∞–Ω: ${name} (ID: ${id})`);
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è –∑–∞–∫–∞–∑–∞
            localStorage.setItem('selectedPlayer', JSON.stringify({id, name}));
            document.getElementById('result').innerHTML += `
                <div style="background:#d4ffd4; padding:10px; margin-top:10px;">
                    ‚úì –í—ã–±—Ä–∞–Ω–æ: <strong>${name}</strong>
                </div>
            `;
        }
        
        function useDemo(name) {
            document.getElementById('username').value = name;
            selectPlayer(123, name);
        }
        
        // –ê–≤—Ç–æ–ø–æ–∏—Å–∫
        let timer;
        document.getElementById('username').addEventListener('input', function() {
            clearTimeout(timer);
            if (this.value.length >= 3) {
                timer = setTimeout(() => searchRobloxUser(), 500);
            }
        });
    </script>
</body>
</html>
